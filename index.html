<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>18+ Video Access</title>
  <style>
    :root { --bg:#0f1115; --card:#151821; --muted:#9aa3b2; --accent:#3b82f6; --border:#232838; --txt:#e8e8e8; }
    *{box-sizing:border-box}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:var(--txt); margin:0; padding:16px;
      min-height:100vh; display:flex; align-items:center; justify-content:center;
    }
    .card{max-width:700px;width:100%;background:var(--card);border:1px solid var(--border);
      border-radius:16px;padding:16px;box-shadow:0 6px 30px rgba(0,0,0,.35)}
    h1{font-size:20px;margin:0 0 6px}
    .handle{font-size:12px;color:#9aa3b2;margin:0 0 12px}
    .handle a{color:#9aa3b2;text-decoration:none}
    .badge{display:inline-block;font-size:11px;padding:4px 8px;border:1px solid var(--border);
      border-radius:999px;color:#9aa3b2;margin-bottom:10px}
    .preview{aspect-ratio:16/9;background:#0b0d12;border:1px dashed var(--border);
      border-radius:12px;margin:12px 0 8px;display:flex;align-items:center;justify-content:center;
      color:#94a3b8;font-size:13px;overflow:hidden}
    /* –ø–æ–∫–∞–∑—É—î–º–æ –í–ï–°–¨ –ø–æ—Å—Ç–µ—Ä –±–µ–∑ –∫—Ä–æ–ø—É */
    .preview img{width:100%;height:100%;object-fit:contain;display:block}
    .fine{font-size:12px;color:#9aa3b2;margin:8px 0 12px}
    .actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}
    .btn{display:inline-block;padding:12px 18px;border-radius:12px;border:0;background:var(--accent);
      color:#fff;font-weight:700;cursor:pointer}
    .btn.offer{background:#ef4444}
    .btn.ghost{background:transparent;border:1px solid var(--border);color:#e8e8e8}
    .timer{margin-top:8px;font-size:12px;color:#9aa3b2}
    .slot300{display:flex;justify-content:center;margin:10px 0}
    .slot300 .box{width:300px;height:250px}
    .slot320{display:flex;justify-content:center;margin:14px 0 4px}
    .slot320 .box{width:320px;height:50px}
    @media (max-width:360px){ .slot300{transform:scale(.95);transform-origin:top center} }
  </style>
</head>
<body>
  <div class="card">
    <div class="badge">18+ content ‚Ä¢ adults only</div>
    <h1 id="title">Confirm 18+ to watch</h1>
    <div class="handle">channel: <a href="https://t.me/massimo_desu" target="_blank" rel="noopener">@massimo_desu</a></div>

    <!-- –ü—Ä–µ–≤'—é –∑ –¥–µ—Ñ–æ–ª—Ç–Ω–∏–º –ø–æ—Å—Ç–µ—Ä–æ–º 3 –¥—ñ–≤—á–∞—Ç (ABSOLUTE URL) -->
    <div class="preview" id="preview">Loading preview‚Ä¶</div>

    <!-- TOP Adsterra 300x250 -->
    <div class="slot300">
      <div class="box" id="ad_top_300">
        <script type="text/javascript">
          atOptions = { 'key':'c493e0c00ad06c76089c47fdbb8fc023', 'format':'iframe', 'height':250, 'width':300, 'params':{} };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/c493e0c00ad06c76089c47fdbb8fc023/invoke.js"></script>
      </div>
    </div>

    <p class="fine" id="note">Enjoy your time watching, dear anime connoisseurs, stay with usü´¶</p>

    <div class="actions">
      <button class="btn" id="watchBtn">Watch FULL</button>
      <button class="btn ghost" id="openInBrowser" style="display:none">Open in Browser</button>
      <a class="btn offer" id="offerBtn"
         href="https://www.revenuecpmgate.com/a0vdxj40u7?key=caff2ec1b619c7bc75892bfffdea43a6"
         target="_blank" rel="noopener">Extra 18+</a>
    </div>

    <div class="timer" id="status"></div>

    <!-- BOTTOM Adsterra 320x50 -->
    <div class="slot320">
      <div class="box" id="ad_bottom_320">
        <script type="text/javascript">
          atOptions = { 'key':'4408059fb33cba75abbc00cec4c087af', 'format':'iframe', 'height':50, 'width':320, 'params':{} };
        </script>
        <script type="text/javascript" src="//www.highperformanceformat.com/4408059fb33cba75abbc00cec4c087af/invoke.js"></script>
      </div>
    </div>
  </div>

  <script>
    // ---- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑ —Ö–µ—à–∞: #v=...|img=...|delay=7|t=...|btn=...|note=...|offer=...|offerText=... ----
    function parseHash(){
      const raw=(location.hash||"").replace(/^#/,"");
      const out={}; if(!raw) return out;
      raw.split("|").forEach(p=>{const i=p.indexOf("="); if(i>0){out[p.slice(0,i).trim()]=decodeURIComponent(p.slice(i+1).trim());}});
      return out;
    }
    const p = parseHash();
    const V   = p.v   || "";
    const IMG = p.img || "";
    const D   = Math.max(0, parseInt(p.delay || "7", 10));

    if(p.t)   document.getElementById("title").textContent = p.t;
    if(p.btn) document.getElementById("watchBtn").textContent = p.btn;
    if(p.note)document.getElementById("note").textContent = p.note;
    if(p.offer){ const ob=document.getElementById("offerBtn"); ob.href=p.offer; if(p.offerText) ob.textContent=p.offerText; }

    // --- –ü–æ–∫–∞–∑—É—î–º–æ –¥–µ—Ñ–æ–ª—Ç–Ω–∏–π –ø–æ—Å—Ç–µ—Ä —á–µ—Ä–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–∏–π URL (TG webview —ñ–Ω–∫–æ–ª–∏ –ª–∞–º–∞—î root-—Å–ª–µ—à) ---
    (function(){
      const ABS = "https://massimodesu.github.io/three_girls_crop_1280x720.jpg"; // –∞–±—Å–æ–ª—é—Ç–Ω–∞ –∞–¥—Ä–µ—Å–∞
      const src = IMG || (ABS + "?v=1");
      const im = new Image();
      im.alt = "Cover";
      im.onload = () => { const b=document.getElementById("preview"); b.innerHTML=""; b.appendChild(im); };
      im.src = src;
    })();

    const statusEl = document.getElementById("status");
    const btn = document.getElementById("watchBtn");
    const openBtn = document.getElementById("openInBrowser");

    // --- –î–µ—Ç–µ–∫—Ç Telegram / –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ ---
    const ua = navigator.userAgent || "";
    const isTelegram = /Telegram/i.test(ua);
    const isAndroid  = /Android/i.test(ua);
    const isIOS      = /iPhone|iPad|iPod/i.test(ua);

    // –£ Telegram –ø–æ–∫–∞–∑—É—î–º–æ –¥–æ–ø–æ–º—ñ–∂–Ω—É –∫–Ω–æ–ø–∫—É "Open in Browser"
    if (isTelegram) {
      openBtn.style.display = "inline-block";
      openBtn.addEventListener("click", ()=>{
        const link = V || location.href;
        try { navigator.clipboard && navigator.clipboard.writeText(link); } catch(e){}
        alert(isIOS
          ? 'Tap ‚Ä¢‚Ä¢‚Ä¢ (top-right) ‚Üí "Open in Browser". Link copied to clipboard.'
          : 'Opening in external browser may work better. Link copied to clipboard.'
        );
      });
    }

    if(!V){ btn.disabled=true; statusEl.textContent="Error: missing video URL (v= in the hash)."; }

    // ---- –ü–ï–†–ï–•–Ü–î –ë–ï–ó about:blank ----
    function goSameTab(url){
      try{ window.location.assign(url); }catch(e){}
      try{ window.location.replace(url); }catch(e){}
      try{ window.open(url,'_self'); }catch(e){}
    }

    function openForTelegram(url){
      if (isAndroid) {
        // –ø—Ä–æ–±—É—î–º–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ Chrome —á–µ—Ä–µ–∑ intent:// (–±—ñ–ª—å—à—ñ—Å—Ç—å TG Android –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å)
        try {
          const cleaned = url.replace(/^https?:\/\//,'');
          const intent = "intent://" + cleaned + "#Intent;scheme=https;package=com.android.chrome;end";
          window.location.href = intent;
          setTimeout(()=>goSameTab(url), 700); // —Ñ–æ–ª–±–µ–∫
          return;
        } catch(e) { /* ignore */ }
      }
      // iOS TG –∞–±–æ –Ω–µ–≤–¥–∞–ª–∏–π intent ‚Äî –ø—Ä–æ—Å—Ç–æ –π–¥–µ–º–æ –∑–≤–∏—á–∞–π–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º
      goSameTab(url);
    }

    btn.addEventListener('click', ()=>{
      try{ localStorage.setItem('vgate_next', JSON.stringify({url:V, ts:Date.now()})); }catch(e){}
      // —É Telegram –¥–∞—î–º–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É –∑–∞—Ç—Ä–∏–º–∫—É 5c, —è–∫—â–æ –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–æ –º–µ–Ω—à–µ ‚Äî –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
      const delay = isTelegram ? Math.max(D, 5) : D;
      const end = Date.now() + delay*1000;

      (function tick(){
        const left=Math.max(0,Math.ceil((end-Date.now())/1000));
        statusEl.textContent="Preparing your video‚Ä¶ "+left+"s";
        if(Date.now()>=end){
          isTelegram ? openForTelegram(V) : goSameTab(V);
        } else { setTimeout(tick,250); }
      })();

      // –¥—É–±–ª—é—é—á—ñ —Å–ø—Ä–æ–±–∏ –ø—ñ—Å–ª—è —Ç–∞–π–º–µ—Ä–∞
      setTimeout(()=>{ isTelegram ? openForTelegram(V) : goSameTab(V); }, (delay+0.6)*1000);
      setTimeout(()=>{ isTelegram ? openForTelegram(V) : goSameTab(V); }, (delay+2.0)*1000);
      setTimeout(()=>{ isTelegram ? openForTelegram(V) : goSameTab(V); }, (delay+4.0)*1000);
    });
  </script>
</body>
</html>
